"use strict";module.exports={formatDate:function formatDate(date,fmt){date=date==undefined?new Date:date;date=typeof date=="number"?new Date(date):date;fmt=fmt||"yyyy-MM-dd HH:mm:ss";var obj={y:date.getFullYear(),M:date.getMonth()+1,d:date.getDate(),q:Math.floor((date.getMonth()+3)/3),w:date.getDay(),H:date.getHours(),h:date.getHours()%12==0?12:date.getHours()%12,m:date.getMinutes(),s:date.getSeconds(),S:date.getMilliseconds()};var week=["天","一","二","三","四","五","六"];for(var i in obj){fmt=fmt.replace(new RegExp(i+"+","g"),function(m){var val=obj[i]+"";if(i=="w")return(m.length>2?"星期":"周")+week[val];for(var j=0,len=val.length;j<m.length-len;j++){val="0"+val}return m.length==1?val:val.substring(val.length-m.length)})}return fmt},timetrans:function timetrans(date){var date=new Date(date*1e3);var Y=date.getFullYear()+"-";var M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-";var D=(date.getDate()<10?"0"+date.getDate():date.getDate())+" ";var h=(date.getHours()<10?"0"+date.getHours():date.getHours())+":";var m=(date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes())+":";var s=date.getSeconds()<10?"0"+date.getSeconds():date.getSeconds();return Y+M+D+h+m+s},formatDateToFriendly:function formatDateToFriendly(date){date=date||new Date;date=typeof date==="number"?new Date(date):date;var now=new Date;if(now.getTime()-date.getTime()<60*1e3)return"刚刚";var temp=this.formatDate(date,"yyyy年M月d日");if(temp==this.formatDate(now,"yyyy年M月d日"))return this.formatDate(date,"HH:mm");if(date.getFullYear()==now.getFullYear())return this.formatDate(date,"M月d日");return temp},friendlyDate:function friendlyDate(time){var offset=+new Date-time;var seconds=1e3,minutes=seconds*60,hours=minutes*60,days=hours*24,months=days*30,years=months*12;var t;if(offset>=years){t=parseInt(offset/years);return t+"年前"}else if(offset>=months){t=parseInt(offset/months);return t+"个月前"}else if(offset>=days){t=parseInt(offset/days);return t+"天前"}else if(offset>=hours){t=parseInt(offset/hours);return t+"小时前"}else if(offset>=minutes){t=parseInt(offset/minutes);return t+"分钟前"}else if(offset>=seconds){return"刚刚"}},formatDurationToFriendly:function formatDurationToFriendly(second){if(second<60)return second+"秒";else if(second<60*60)return(second-second%60)/60+"分"+second%60+"秒";else if(second<60*60*24)return(second-second%3600)/60/60+"小时"+Math.round(second%3600/60)+"分";return(second/60/60/24).toFixed(1)+"天"},formatTimeToFriendly:function formatTimeToFriendly(second){var m=Math.floor(second/60);m=m<10?"0"+m:m;var s=second%60;s=s<10?"0"+s:s;return m+":"+s},isLeapYear:function isLeapYear(year){if(year===undefined)year=new Date;if(year instanceof Date)year=year.getFullYear();return year%4==0&&year%100!=0||year%400==0},getMonthDays:function getMonthDays(date,month){var y=void 0,m=void 0;if(date==undefined)date=new Date;if(date instanceof Date){y=date.getFullYear();m=date.getMonth()}else if(typeof date=="number"){y=date;m=month-1}var days=[31,28,31,30,31,30,31,31,30,31,30,31];if(m==1&&this.isLeapYear(y))return days[m]+1;return days[m]},countDays:function countDays(date1,date2){var fmt="yyyy-MM-dd";if(date1 instanceof Date&&date2 instanceof Date){date1=this.format(fmt,date1);date2=this.format(fmt,date2)}if(typeof date1==="string"&&typeof date2==="string"){date1=this.parseDate(date1,fmt);date2=this.parseDate(date2,fmt);return(date1.getTime()-date2.getTime())/(1e3*60*60*24)}else{console.error("参数格式无效！");return 0}},parseDate:function parseDate(str,fmt){fmt=fmt||"yyyy-MM-dd";var obj={y:0,M:1,d:0,H:0,h:0,m:0,s:0,S:0};fmt.replace(/([^yMdHmsS]*?)(([yMdHmsS])\3*)([^yMdHmsS]*?)/g,function(m,$1,$2,$3,$4,idx,old){str=str.replace(new RegExp($1+"(\\d{"+$2.length+"})"+$4),function(_m,_$1){obj[$3]=parseInt(_$1);return""});return""});obj.M--;var date=new Date(obj.y,obj.M,obj.d,obj.H,obj.m,obj.s);if(obj.S!==0)date.setMilliseconds(obj.S);return date},getEndTime:function getEndTime(endTime){var startDate=new Date;var endDate=new Date(endTime);var t=endDate.getTime()-startDate.getTime();var d=0,h=0,m=0,s=0;if(t>=0){d=Math.floor(t/1e3/3600/24);h=Math.floor(t/1e3/60/60%24);m=Math.floor(t/1e3/60%60);s=Math.floor(t/1e3%60)}return{d:d,h:h,m:m,s:s}},getMonthOfDay:function getMonthOfDay(time){var date=new Date(time);var year=date.getFullYear();var mouth=date.getMonth()+1;var days;if(mouth==2){days=year%4==0&&year%100==0&&year%400==0||year%4==0&&year%100!=0?28:29}else if(mouth==1||mouth==3||mouth==5||mouth==7||mouth==8||mouth==10||mouth==12){days=31}else{days=30}return days},getYearOfDay:function getYearOfDay(time){var firstDayYear=this.getFirstDayOfYear(time);var lastDayYear=this.getLastDayOfYear(time);var numSecond=(new Date(lastDayYear).getTime()-new Date(firstDayYear).getTime())/1e3;return Math.ceil(numSecond/(24*3600))},getFirstDayOfYear:function getFirstDayOfYear(time){var year=new Date(time).getFullYear();return year+"-01-01 00:00:00"},getLastDayOfYear:function getLastDayOfYear(time){var year=new Date(time).getFullYear();var dateString=year+"-12-01 00:00:00";var endDay=this.getMonthOfDay(dateString);return year+"-12-"+endDay+" 23:59:59"},getDayOfYear:function getDayOfYear(time){var firstDayYear=this.getFirstDayOfYear(time);var numSecond=(new Date(time).getTime()-new Date(firstDayYear).getTime())/1e3;return Math.ceil(numSecond/(24*3600))},getDayOfYearWeek:function getDayOfYearWeek(time){var numdays=this.getDayOfYear(time);return Math.ceil(numdays/7)},timeFn:function timeFn(time){var fmt=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var dateBegin=new Date(time.replace(/-/g,"/"));var dateEnd=new Date;var dateDiff=dateEnd.getTime()-dateBegin.getTime();var dayDiff=Math.floor(dateDiff/(24*3600*1e3));var leave1=dateDiff%(24*3600*1e3);var hours=Math.floor(leave1/(3600*1e3));var leave2=leave1%(3600*1e3);var minutes=Math.floor(leave2/(60*1e3));var leave3=leave2%(60*1e3);var seconds=Math.round(leave3/1e3);if(fmt){return"相差"+dayDiff+"天"+hours+"小时"+minutes+"分钟"+seconds+"秒"}return dateDiff+"时间差的毫秒数,"+dayDiff+"计算出相差天数,"+leave1+"计算天数后剩余的毫秒数,"+hours+"计算出小时数,"+minutes+"计算相差分钟数,"+seconds+"计算相差秒数"}};