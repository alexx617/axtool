"use strict";function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}module.exports={ajax:function ajax(setting){var opts={method:(setting.method||"GET").toUpperCase(),url:setting.url||"",async:setting.async||true,dataType:setting.dataType||"json",data:setting.data||"",success:setting.success||function(){},error:setting.error||function(){}};function params_format(obj){var str="";for(var i in obj){str+=i+"="+obj[i]+"&"}return str.split("").slice(0,-1).join("")}var xhr=new XMLHttpRequest;if(opts.method=="GET"){xhr.open(opts.method,opts.url+"?"+params_format(opts.data),opts.async);xhr.send()}else{xhr.open(opts.method,opts.url,opts.async);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send(opts.data)}xhr.onreadystatechange=function(){if(xhr.readyState===4&&(xhr.status===200||xhr.status===304)){switch(opts.dataType){case"json":var json=JSON.parse(xhr.responseText);opts.success(json);break;case"xml":opts.success(xhr.responseXML);break;default:opts.success(xhr.responseText);break}}};xhr.onerror=function(err){opts.error(err)}},fetch:function(_fetch){function fetch(_x,_x2){return _fetch.apply(this,arguments)}fetch.toString=function(){return _fetch.toString()};return fetch}(function(url,setting){var _this=this;var opts={method:(setting.method||"GET").toUpperCase(),headers:setting.headers||{},credentials:setting.credentials||true,body:setting.body||{},mode:setting.mode||"no-cors",redirect:setting.redirect||"follow",cache:setting.cache||"default"};var dataType=setting.dataType||"json",data=setting.data||"";function params_format(obj){var str="";for(var i in obj){str+=i+"="+obj[i]+"&"}return str.split("").slice(0,-1).join("")}if(opts.method==="GET"){url=url+(data?"?"+params_format(data):"")}else{setting.body=data||{}}return new Promise(function(resolve,reject){fetch(url,opts).then(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(res){var data;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(dataType==="text")){_context.next=6;break}_context.next=3;return res.text();case 3:_context.t0=_context.sent;_context.next=16;break;case 6:if(!(dataType==="blob")){_context.next=12;break}_context.next=9;return res.blob();case 9:_context.t1=_context.sent;_context.next=15;break;case 12:_context.next=14;return res.json();case 14:_context.t1=_context.sent;case 15:_context.t0=_context.t1;case 16:data=_context.t0;resolve(data);case 18:case"end":return _context.stop()}}},_callee,_this)}));return function(_x3){return _ref.apply(this,arguments)}}()).catch(function(e){reject(e)})})})};